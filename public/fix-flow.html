<!DOCTYPE html>
<html>
<head>
    <title>üîß Fix Flow Issues - Quick Test</title>
    <style>
        body { font-family: Arial, sans-serif; max-width: 600px; margin: 50px auto; padding: 20px; }
        .button { background: #2563eb; color: white; padding: 12px 24px; border: none; border-radius: 6px; cursor: pointer; font-size: 16px; margin: 10px 10px 10px 0; }
        .button:hover { background: #1d4ed8; }
        .button.danger { background: #dc2626; }
        .button.danger:hover { background: #b91c1c; }
        .success { color: #059669; font-weight: bold; margin: 20px 0; }
        .info { background: #f3f4f6; padding: 15px; border-radius: 6px; margin: 20px 0; }
    </style>
</head>
<body>
    <h1>üîß Quick Fix & Test Flow</h1>
    
    <div class="info">
        <h3>üö® Issues Found:</h3>
        <p>1. Tools ‚Üí Clusters button going to old flow<br>
        2. React DOM removeChild errors on navigation</p>
        
        <h3>‚úÖ Fixes Applied:</h3>
        <p>1. Removed all Link components from clusters page<br>
        2. Using window.location.href for navigation<br>
        3. Restarted server to clear cache</p>
    </div>
    
    <h3>üßπ Clear Everything & Test:</h3>
    <button onclick="clearAll()" class="button danger">1. Clear All Cache & Storage</button>
    <button onclick="goToTools()" class="button">2. Go to Tools Page</button>
    
    <div id="result"></div>
    
    <div class="info">
        <h3>üìù Test Steps After Clearing:</h3>
        <ol>
            <li><strong>Go to Tools</strong> ‚Üí Should show tools page</li>
            <li><strong>Click "Research Clusters Analysis"</strong> ‚Üí Should go to FORM page (not clusters)</li>
            <li><strong>Fill form with .edu email</strong> ‚Üí Should redirect to clusters</li>
            <li><strong>Click "Back to Tools"</strong> ‚Üí Should work without errors</li>
        </ol>
    </div>

    <script>
        function clearAll() {
            // Clear localStorage
            localStorage.clear();
            
            // Clear sessionStorage
            sessionStorage.clear();
            
            // Clear cookies
            document.cookie.split(";").forEach(function(c) { 
                document.cookie = c.replace(/^ +/, "").replace(/=.*/, "=;expires=" + new Date().toUTCString() + ";path=/"); 
            });
            
            // Clear cache if supported
            if ('caches' in window) {
                caches.keys().then(names => {
                    names.forEach(name => {
                        caches.delete(name);
                    });
                });
            }
            
            showResult('‚úÖ All cache, storage, and cookies cleared!');
            
            // Force hard refresh after clearing
            setTimeout(() => {
                window.location.reload(true);
            }, 1500);
        }
        
        function goToTools() {
            showResult('üîÑ Navigating to tools page...');
            setTimeout(() => {
                window.location.href = '/tools';
            }, 500);
        }
        
        function showResult(message) {
            document.getElementById('result').innerHTML = 
                '<div class="success">' + message + '</div>';
        }
        
        // Show current status
        window.onload = function() {
            const hasAuth = localStorage.getItem('manaboodle_edu_access');
            const email = localStorage.getItem('manaboodle_edu_email');
            
            if (hasAuth && email) {
                showResult('‚ö†Ô∏è Found existing auth: ' + email + ' - Clear it first!');
            } else {
                showResult('‚úÖ No existing auth found - ready to test!');
            }
        }
    </script>
</body>
</html>
